<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>トレーニング＆体重記録</title>
  <style>
    body {
      font-family: sans-serif;
      padding: 1rem;
      background-color: #4a90e2;
      color: #333;
    }
    h1, h2 {
      color: #fff;
      text-align: center;
    }
    .input-group {
      margin-bottom: 1rem;
    }
    label {
      display: block;
      margin-top: 0.5rem;
    }
    input[type="date"], input[type="number"], textarea {
      width: 100%;
      padding: 0.5rem;
      border-radius: 5px;
      border: 1px solid #ccc;
    }
    .exercise-grid {
      display: flex;
      flex-wrap: wrap;
      justify-content: space-around;
      gap: 1rem;
    }
    .exercise-box {
      background: white;
      border-radius: 10px;
      padding: 1rem;
      flex: 1 1 40%;
      box-shadow: 0 2px 6px rgba(0,0,0,0.2);
    }
    .exercise-box h3 {
      margin-top: 0;
    }
    .exercise-label {
      display: inline-block;
      cursor: pointer;
      margin: 0.2rem;
      padding: 0.5rem 1rem;
      border-radius: 20px;
      background: #eee;
      transition: background 0.3s;
    }
    .exercise-label.selected.muscle {
      background: red;
      color: #fff;
    }
    .exercise-label.selected.cardio {
      background: orange;
      color: #333;
    }
    button#saveButton {
      font-size: 1.2rem;
      padding: 1rem 2rem;
      margin: 1rem auto;
      display: block;
      background-color: #0055cc;
      color: white;
      border: none;
      border-radius: 8px;
    }
    #chart {
      margin-top: 2rem;
      background: #fff;
      border-radius: 8px;
      padding: 1rem;
      overflow-x: auto;
    }
    .bar-wrapper {
      display: flex;
      align-items: flex-end;
      height: 200px;
    }
    .bar-column {
      display: flex;
      flex-direction: column;
      align-items: center;
      margin: 0 6px;
      width: 20px;
    }
    .block {
      width: 100%;
      margin-top: 1px;
    }
    .block.筋トレ {
      background: red;
      height: 15px;
    }
    .block.有酸素 {
      background: orange;
      height: 15px;
    }
    .weight-point {
      background: navy;
      color: white;
      border-radius: 50%;
      padding: 2px 5px;
      font-size: 0.75rem;
      margin-top: 5px;
    }
  </style>
</head>
<body>
  <h1>トレーニング & 体重記録</h1>
  <div class="input-group">
    <label for="date">日付:</label>
    <input type="date" id="date">
    <label for="weight">体重（kg）:</label>
    <input type="number" id="weight" step="0.1">
    <label for="note">コメント（任意）:</label>
    <textarea id="note" rows="2" placeholder="今日の感想や特記事項など"></textarea>
  </div>
  <div class="exercise-grid">
    <div class="exercise-box">
      <h3 style="color:red">筋トレ</h3>
      <span class="exercise-label" onclick="toggleExercise(this, '3／7腕立て伏せ')">3／7腕立て伏せ</span>
      <span class="exercise-label" onclick="toggleExercise(this, '三角筋')">三角筋</span>
      <span class="exercise-label" onclick="toggleExercise(this, '腹筋')">腹筋</span>
    </div>
    <div class="exercise-box">
      <h3 style="color:orange">有酸素</h3>
      <span class="exercise-label" onclick="toggleExercise(this, 'エアロビクス')">エアロビクス</span>
      <span class="exercise-label" onclick="toggleExercise(this, 'ジョギング')">ジョギング</span>
    </div>
  </div>
  <button id="saveButton" onclick="saveRecord()">記録する</button>
  <div id="chart"></div>

  <script>
    const dateInput = document.getElementById('date');
    const noteInput = document.getElementById('note');
    const weightInput = document.getElementById('weight');
    const chart = document.getElementById('chart');
    let selectedExercises = [];

    dateInput.valueAsDate = new Date();

    function toggleExercise(el, name) {
      const idx = selectedExercises.indexOf(name);
      if (idx === -1) {
        selectedExercises.push(name);
        el.classList.add('selected');
        const cat = getCategory(name);
        el.classList.add(cat === '筋トレ' ? 'muscle' : cat === '有酸素' ? 'cardio' : '');
      } else {
        selectedExercises.splice(idx, 1);
        el.classList.remove('selected', 'muscle', 'cardio');
      }
    }

    function getCategory(item) {
      const muscle = ['三角筋', '腹筋', '3／7腕立て伏せ'];
      const cardio = ['ジョギング', 'エアロビクス'];
      if (muscle.includes(item)) return '筋トレ';
      if (cardio.includes(item)) return '有酸素';
      return 'その他';
    }

    function saveRecord() {
      const date = dateInput.value;
      const weight = weightInput.value;
      const note = noteInput.value;
      if (!date) return alert('日付は必須です');
      const record = { date, weight, items: [...selectedExercises], note };
      const records = JSON.parse(localStorage.getItem('trainingRecords') || '[]');
      records.push(record);
      localStorage.setItem('trainingRecords', JSON.stringify(records));
      selectedExercises = [];
      noteInput.value = '';
      weightInput.value = '';
      document.querySelectorAll('.exercise-label').forEach(el => el.classList.remove('selected', 'muscle', 'cardio'));
      renderChart();
    }

    function renderChart() {
      const records = JSON.parse(localStorage.getItem('trainingRecords') || '[]')
        .sort((a, b) => new Date(a.date) - new Date(b.date));
      chart.innerHTML = '';
      const wrapper = document.createElement('div');
      wrapper.className = 'bar-wrapper';

      records.forEach(rec => {
        const col = document.createElement('div');
        col.className = 'bar-column';
        col.innerHTML = `<div>${rec.date.split('-')[2]}</div>`;
        if (rec.items) {
          rec.items.forEach(item => {
            const block = document.createElement('div');
            block.className = 'block ' + getCategory(item);
            col.appendChild(block);
          });
        }
        if (rec.weight) {
          const point = document.createElement('div');
          point.className = 'weight-point';
          point.textContent = rec.weight + 'kg';
          col.appendChild(point);
        }
        wrapper.appendChild(col);
      });
      chart.appendChild(wrapper);
    }

    renderChart();
  </script>
</body>
</html>
